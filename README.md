# 🗺️ GeoJSON地図ビューアー

Open Street MapとLeafletを使用したインタラクティブなGeoJSONファイルビューアーです。GeoJSONファイルをドラッグ＆ドロップするだけで、地図上に簡単に重畳表示できます。

## 📋 目次

- [機能](#機能)
- [使用方法](#使用方法)
- [対応ファイル形式](#対応ファイル形式)
- [技術仕様](#技術仕様)
- [セットアップ](#セットアップ)
- [使用例](#使用例)
- [カスタマイズ](#カスタマイズ)
- [トラブルシューティング](#トラブルシューティング)
- [ライセンス](#ライセンス)

## ✨ 機能

### 🎯 主要機能
- **ドラッグ＆ドロップ対応**: GeoJSONファイルを地図上に簡単に読み込み
- **複数レイヤー管理**: 複数のGeoJSONファイルを同時に表示・管理
- **ベースマップ切替**: OpenStreetMap / 地理院地図（標準） / 地理院白地図（blank）
- **レイヤー表示のオン/オフ**: チェックボックスで個別に制御
- **レイヤー色の変更**: カラーピッカーで任意の色に即時変更（ポイント/ライン/ポリゴン対応）
- **インタラクティブポップアップ**: フィーチャーをクリックして詳細情報を表示
- **長いファイル名の折り返し表示**: サイドバーでレイヤー名が省略されずに表示

### 🎨 デザイン機能
- **レスポンシブデザイン**: デスクトップ・モバイル対応
- **モダンUI**: 直感的で使いやすいインターフェース
- **リアルタイムフィードバック**: ドラッグオーバー時の視覚的フィードバック

### 🔧 管理機能
- **レイヤー削除**: 不要なレイヤーを簡単に削除
- **フィーチャー数表示**: 各レイヤーのデータ数を表示
- **自動ズーム**: 読み込んだデータに合わせて地図を調整

## 🚀 使用方法

### 基本的な使い方

1. **ベースマップを選択（任意）**
   - サイドバー上部のプルダウンで `OpenStreetMap / 地理院地図（標準） / 地理院白地図` を選択。
2. **ファイルの読み込み**
   - ドロップエリアにGeoJSONファイルをドラッグ＆ドロップ
   - または、ドロップエリアをクリックしてファイル選択ダイアログを開く
   - 地図上に直接ファイルをドロップすることも可能
3. **レイヤー管理（読み込み後）**
   - レイヤー名の右側にあるチェックボックスで表示のオン/オフを切り替え
   - カラーピッカーで色を変更（ポイントは塗り色、ライン/ポリゴンは線色と塗り色に適用）
   - 「削除」ボタンでレイヤーを地図から削除

### 地図操作
- マウスホイール：拡大縮小
- ドラッグ：地図の移動
- フィーチャークリック：詳細情報をポップアップ表示

## 📁 対応ファイル形式

- **.geojson**: 標準的なGeoJSONファイル
- **.json**: JSON形式のGeoJSONファイル

### サポートするGeoJSONフィーチャータイプ
- **Point** / **MultiPoint**
- **LineString** / **MultiLineString**
- **Polygon** / **MultiPolygon**
- **GeometryCollection**

## 🛠️ 技術仕様

### 使用ライブラリ
- **[Leaflet.js](https://leafletjs.com/)** v1.9.4: インタラクティブ地図ライブラリ
- ベースマップタイル
  - **OpenStreetMap**: `https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png`
  - **地理院地図（標準）**: `https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png`
  - **地理院白地図（blank）**: `https://cyberjapandata.gsi.go.jp/xyz/blank/{z}/{x}/{y}.png`

### ブラウザ対応
- Chrome（推奨） / Firefox / Safari / Edge

### 必要環境
- モダンブラウザ（ES6対応）
- インターネット接続（地図タイル読み込み用）

## ⚡ セットアップ

### 簡単セットアップ
1. リポジトリをクローンまたはダウンロード
2. `index.html`をブラウザで開く
3. すぐに使用開始！

### Webサーバーでの実行（推奨）
```bash
# Python3
python -m http.server 8000

# Node.js (serve)
npx serve .
```
ブラウザで `http://localhost:8000` にアクセス

## 💡 使用例

### サンプルGeoJSONデータ

#### ポイントデータ例
```json
{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "geometry": { "type": "Point", "coordinates": [139.7671, 35.6812] },
      "properties": { "name": "東京駅", "category": "交通" }
    }
  ]
}
```

#### ポリゴンデータ例
```json
{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [[
          [139.7500, 35.6700],
          [139.7800, 35.6700],
          [139.7800, 35.6900],
          [139.7500, 35.6900],
          [139.7500, 35.6700]
        ]]
      },
      "properties": { "name": "中央区エリア", "area": "商業地域" }
    }
  ]
}
```

## 🎨 カスタマイズ

- **初期色のランダム候補を変更**: `index.html` の `getRandomColor()` の配列を編集
- **デフォルトのベースマップ**: `index.html` の `currentBaseLayer = baseLayers.osm.addTo(map);` を任意に変更
- **タイルを追加**: `baseLayers` に新しい `L.tileLayer()` を追加し、セレクトボックスにも `option` を追加

## 🐛 トラブルシューティング

### よくある問題と解決方法

#### ファイルが読み込まれない
- **原因**: 無効なGeoJSON形式
- **解決**: GeoJSONの構文を確認（[GeoJSON.io](http://geojson.io/)で検証推奨）

#### 地図が表示されない
- **原因**: インターネット接続の問題
- **解決**: ネットワーク接続を確認

#### レイヤーが表示されない
- **原因**: 座標系の問題（WGS84以外）
- **解決**: 座標をWGS84（EPSG:4326）に変換

#### パフォーマンスが低下する
- **原因**: 大量のフィーチャーを含むファイル
- **解決**: データを分割するか、間引き処理を実装

### デバッグメモ
- ブラウザの開発者ツールで、読み込みログやエラー、クリック座標を確認できます

## 📄 ライセンス

MIT License

このプロジェクトはMITライセンスの下で公開されています。詳細は[LICENSE](LICENSE)ファイルをご覧ください。

## 📞 サポート

質問や問題がある場合は、GitHubのIssuesタブからお気軽にお問い合わせください。

---

**Happy Mapping! 🗺️✨** 